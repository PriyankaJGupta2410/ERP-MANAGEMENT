<!DOCTYPE html>
<html>
<head>
  <title>Staff List</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background-color: #f9f9f9;
    }

    h2 {
      text-align: center;
      color: #333;
    }

    #dashboard-btn {
      position: absolute;
      top: 20px;
      right: 30px;
      padding: 10px 15px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      text-decoration: none;
    }

    #dashboard-btn:hover {
      background-color: #218838;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 60px;
      background-color: #fff;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ccc;
    }

    th {
      background-color: #007BFF;
      color: white;
    }

    tr:hover {
      background-color: #f1f1f1;
    }

    #error-message {
      color: red;
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <a href="/Superadmindashboard" id="dashboard-btn">Go to Dashboard</a>

  <h2>All Staff Records</h2>

  <div id="error-message"></div>
  <div id="staffTable"></div>

  <script>
    async function fetchStaffData() {
      const token = localStorage.getItem("token");
      if (!token) {
        document.getElementById("error-message").innerText = "Authentication token missing.";
        return;
      }

      try {
        const res = await fetch('http://127.0.0.1:5000/staff/GETstaff', {
          method: 'GET',
          headers: {
            'x-access-token': token
          }
        });

        const result = await res.json();

        if (res.status === 200 && result.status === "success" && Array.isArray(result.res_data)) {
          const staffList = result.res_data;
          let html = '<table>';
          html += `
            <tr>
              <th>Username</th>
              <th>Email</th>
              <th>Contact</th>
              <th>Role</th>
              <th>Salary</th>
              <th>Join Date</th>
              <th>Status</th>
            </tr>`;

          staffList.forEach(staff => {
            html += `
              <tr>
                <td>${staff.username}</td>
                <td>${staff.email}</td>
                <td>${staff.contact}</td>
                <td>${staff.role}</td>
                <td>${staff.salary}</td>
                <td>${staff.join_date}</td>
                <td>${staff.status}</td>
              </tr>`;
          });

          html += '</table>';
          document.getElementById('staffTable').innerHTML = html;
        } else {
          document.getElementById("error-message").innerText = result.message || "Failed to fetch staff data.";
        }

      } catch (err) {
        document.getElementById("error-message").innerText = "Error fetching data: " + err.message;
      }
    }

    window.onload = fetchStaffData;
  </script>

</body>
</html>
